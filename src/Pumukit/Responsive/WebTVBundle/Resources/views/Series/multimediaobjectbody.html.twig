{% if is_series %}
  <!-- SUBSERIAL -->
  {% if not mm.getProperty("subseries") %}
    <div class="inter_mm"></div>
  {% endif %}
  <!-- PRECINCT -->
  {% set mm_precinct = precinct(mm.getTags()) %}
  {% if ((mm_precinct) and ((mm_precinct != last_precinct) or ((last_date|date('Y-m-d')) != (mm.getRecordDate()|date('Y-m-d')))) and (mm_precinct.getCod() != 'PLACE0001PRECINCT01') and (not series_precinct)) %}
    <div class="serial_place">
      {{ mm_precinct|precinct_fulltitle }}
    </div>
  {% endif %}
  <!-- SUBSERIAL -->
  {% if ((("date_subserial" == template) and (mm.getProperty('subseriestitle') and (((mm.getProperty('subseriestitle')|raw) != last_subseriestitle) or ((last_date|date('Y-m-d')) != (mm.getRecordDate()|date('Y-m-d')))))) or (("subserial" == template) and (mm.getProperty('subseriestitle') and ((mm.getProperty('subseriestitle')|raw) != last_subseriestitle)))) %}
    <div class="serial_date">{{ mm.getProperty('subseriestitle')[app.request.getLocale()] }}</div>
  {% endif %}
  <!-- MULTISUBSERIAL -->
  {% if template == "multisubserial" %}
    {% set subseries_now = (mm.getProperty('subseriestitle')[app.request.getLocale()]|split("\\n")) %}
    {% set subseries_before = (last_subseriestitle[app.request.getLocale()]|split("\\n")) %}
    {% set all_subseries = false %}
    {% for key, subseries_text in subseries_now %}
      {% if (all_subseries or ((subseries_before|length) <= key) or ((subseries_text|raw) != subseries_before[key])) %}
        {% set all_subseries = true %}
        <div class="serial_date">{{ subseries_text }}</div>
      {% endif %}
    {% endfor %}
  {% endif %}
{% endif %}
<!-- PIC -->
<div class="col-sm-2 col-xs-3 thumbnailwrapper">
  {% for pic in mm.getPics() if pic.getUrl() is not empty %}
    <div class="thumbnail bodyMm">
      <a href="{{ url('pumukit_responsive_webtv_multimediaobject_index', {'id': mm.id}) }}">
        <img src="{{ pic.getUrl() }}" class="serial img-responsive thumbnailimg">
        <div class="thumbnailholder"></div>
      </a>
    </div>
      {% else %}
    <div class="thumbnail bodyMm">
      <a href="{{ url('pumukit_responsive_webtv_multimediaobject_index', {'id': mm.id}) }}">
        <img src="/bundles/pumukitwebtv/images/no_pic.jpg" class="serial img-responsive thumbnailimg">
        <div class="thumbnailholder"></div>
      </a>
    </div>
  {% endfor %}
</div>                
<div class="col-sm-9 col-xs-8 serial_mm_info">
  <!-- TITLE & SUBTITLE -->
  {% if mm.getTitle() is not empty %}
    <div class="title">"{{ mm.getTitle() }}"</div>
  {% endif %}
  {% if mm.getSubtitle() is not empty %}
    <div class="subtitle">{{ mm.getSubtitle() }}</div>
  {% endif %}
  <div class="objects">
    <!-- MATTERHORN -->
    {% if mm.getProperty('opencast') is not empty %}
      <div id="material" class="file matterhorn">
        <a href="{{ url('pumukit_responsive_webtv_multimediaobject_index', {'id': mm.id}) }}">
          <span class="glyphicon glyphicon-facetime-video" aria-hidden="true"></span>
          {% spaceless %}
            {% trans %}Video{% endtrans %}
            {% if (mm.getBroadcast().getBroadcastTypeId() != public_broadcast()) %}
              {% trans %}private{% endtrans %}
            {% endif %}
          {% endspaceless %}</a>
          &nbsp;|&nbsp;&nbsp;<span class="language">{{ (mm.getProperty('opencastlanguage')?(mm.getProperty('opencastlanguage')|lower):'en')|language_name }}</span>
          &nbsp;|&nbsp; {{ mm.getDuration()|duration_minutes_seconds }}
          &nbsp;|&nbsp; {% trans %}Viewed{% endtrans %}: <span class="numView">{{ mm.getNumview() }}</span>
          {% if (mm.getNumview() == 1) %}{% trans %}time{% endtrans %}{% else %}{% trans %}times{% endtrans %}{% endif %}
      </div>
    {% else %}
      <!-- TRACKS -->
      {% set tracks = mm.getFilteredTracksWithTags(['display'], [], [], []) %}
      {% for track in tracks if not track.getHide() %}
        <div>{# TODO class="file audio|video" and move out gif images to serial.css file, put it in twig #}
          <span class="glyphicon glyphicon-{{ mm.isOnlyAudio() ?'headphones':'facetime-video'}}" aria-hidden="true"></span>
          <a href="{{ url('pumukit_responsive_webtv_multimediaobject_index', {'id': mm.id, 'track_id': track.id}) }}">{% spaceless %}
            {% if track.isOnlyAudio %}
              {% trans %}Audio{% endtrans %}
            {% elseif track.containsTag('download') %}
              {% trans %}Download master{% endtrans %}
            {% else %}
              {% trans %}Video{% endtrans %}
            {% endif %}
            {% if (mm.getBroadcast().getBroadcastTypeId() != public_broadcast()) %}
              {% trans %}private{% endtrans %}
            {% endif %}
          {% endspaceless %}</a>
          &nbsp;|&nbsp;&nbsp;<span class="language">{{ track.getLanguage()|language_name}}</span>
          &nbsp;({{ track.getDuration()|duration_minutes_seconds }})
          &nbsp;|&nbsp; {% trans %}Viewed{% endtrans %}: <span class="numView">{{ mm.getNumview() }}</span>
          {% transchoice mm.getNumview() %}
          {0}times|{1}time|]1,Inf]times
                   {% endtranschoice %}
        </div>
      {% endfor %}
    {% endif %}
    <!-- MATERIAL -->
    {% for material in mm.getMaterials() if not material.getHide() %}
      <div id="material"> 
        <span class="glyphicon glyphicon-file">
          <a target="_blank" href="{{ material.getUrl() }}">{{ material.getName() }}</a>
      </div>
    {% endfor %}
    <!-- LINK -->
    {% for link in mm.getLinks() %}
      <div id="link" class="link">
        <a target="_blank" href="{{ link.getUrl() }}">{{ link.getName() }}</a>
      </div>
    {% endfor %}
  </div>        
  <!-- PERSONS ACT -->
  <div class="persons" style="overflow: hidden; padding-top: 6px;">
    {% for role in mm.getRoles() if role.getDisplay() %}
      {% for person in mm.getPeopleByRole(role) %}
        <div>
          <div class="person">
            {{ role.getText() }}
            {% if person.getWeb() is not empty %}
              <a href="{{ person.getWeb() }}">{{ person.getHName() }}</a>
            {% else %}
              {{ person.getHName() }}
            {% endif %}
          </div>
          {{ person.getInfo() }}
        </div>
      {% endfor %}
    {% endfor %}
  </div>
</div>
